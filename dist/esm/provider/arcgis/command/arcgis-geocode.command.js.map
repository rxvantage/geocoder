{"version":3,"file":"arcgis-geocode.command.js","sourceRoot":"","sources":["../../../../../src/provider/arcgis/command/arcgis-geocode.command.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,cAAc,EAAE,MAAM,kBAAkB,CAAC;AAClD,OAAO,EAAE,YAAY,EAAE,MAAM,gBAAgB,CAAC;AAG9C,OAAO,EAAE,yBAAyB,EAAE,MAAM,SAAS,CAAC;AAEpD;;GAEG;AACH,MAAM,OAAO,oBAAqB,SAAQ,yBAAyB,CAAC,cAAc,CAA8B;IAC5G,YAAY,UAAyB,EAAmB,KAAc;QAClE,KAAK,CAAC,UAAU,CAAC,CAAC;QADkC,UAAK,GAAL,KAAK,CAAS;IAEtE,CAAC;IAED,MAAM,CAAC,MAAM;QACT,OAAO,2FAA2F,CAAC;IACvG,CAAC;IAES,KAAK,CAAC,UAAU,CAAC,KAAmB;QAC1C,MAAM,UAAU,GAAa,EAAE,CAAC;QAEhC,QAAQ,KAAK,CAAC,QAAQ,EAAE;YACpB,KAAK,YAAY,CAAC,YAAY;gBAC1B,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;gBACjC,MAAM;YACV,KAAK,YAAY,CAAC,WAAW;gBACzB,UAAU,CAAC,IAAI,CAAC,eAAe,EAAE,gBAAgB,EAAE,aAAa,CAAC,CAAC;gBAClE,MAAM;YACV,KAAK,YAAY,CAAC,IAAI;gBAClB,UAAU,CAAC,IAAI,CAAC,eAAe,EAAE,gBAAgB,EAAE,aAAa,EAAE,MAAM,CAAC,CAAC;gBAC1E,MAAM;YACV,KAAK,YAAY,CAAC,KAAK;gBACnB,UAAU,CAAC,IAAI,CAAC,eAAe,EAAE,gBAAgB,EAAE,aAAa,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;gBACjG,MAAM;YACV,KAAK,YAAY,CAAC,OAAO;gBACrB,UAAU,CAAC,IAAI,CAAC,eAAe,EAAE,gBAAgB,EAAE,aAAa,EAAE,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;gBACzH,MAAM;SACb;QAED,OAAO;YACH,KAAK,EAAE,IAAI,CAAC,KAAK;YACjB,UAAU,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK;YACxB,OAAO,EAAE,KAAK,CAAC,OAAO;YACtB,WAAW,EAAE,KAAK,CAAC,WAAW,IAAI,KAAK,CAAC,OAAO;YAC/C,MAAM,EAAE,KAAK,CAAC,SAAS,IAAI,KAAK,CAAC,KAAK;YACtC,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,MAAM,EAAE,KAAK,CAAC,UAAU;YACxB,YAAY,EAAE,KAAK,CAAC,KAAK;YACzB,QAAQ,EAAE,KAAK,CAAC,QAAQ;YACxB,QAAQ,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC;YAC9B,eAAe,EAAE,KAAK;YACtB,YAAY,EAAE,SAAS;YACvB,SAAS,EAAE,2FAA2F;YACtG,CAAC,EAAE,MAAM;SACZ,CAAC;IACN,CAAC;CACJ","sourcesContent":["import type { AxiosInstance } from 'axios';\nimport { GeocodeCommand } from '../../../command';\nimport { AccuracyEnum } from '../../../model';\nimport type { GeocodeQuery } from '../../../model';\nimport type { ArcgisGeocodeQueryInterface } from '../interface';\nimport { ArcgisGeocodeCommandMixin } from './mixin';\n\n/**\n * @link {https://developers.arcgis.com/rest/geocode/api-reference/geocoding-find-address-candidates.htm}\n */\nexport class ArcgisGeocodeCommand extends ArcgisGeocodeCommandMixin(GeocodeCommand)<ArcgisGeocodeQueryInterface> {\n    constructor(httpClient: AxiosInstance, private readonly token?: string) {\n        super(httpClient);\n    }\n\n    static getUrl(): string {\n        return 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates';\n    }\n\n    protected async buildQuery(query: GeocodeQuery): Promise<ArcgisGeocodeQueryInterface> {\n        const categories: string[] = [];\n\n        switch (query.accuracy) {\n            case AccuracyEnum.HOUSE_NUMBER:\n                categories.push('Point Address');\n                break;\n            case AccuracyEnum.STREET_NAME:\n                categories.push('Point Address', 'Street Address', 'Street Name');\n                break;\n            case AccuracyEnum.CITY:\n                categories.push('Point Address', 'Street Address', 'Street Name', 'City');\n                break;\n            case AccuracyEnum.STATE:\n                categories.push('Point Address', 'Street Address', 'Street Name', 'City', 'Subregion', 'Region');\n                break;\n            case AccuracyEnum.COUNTRY:\n                categories.push('Point Address', 'Street Address', 'Street Name', 'City', 'Subregion', 'Region', 'Territory', 'Country');\n                break;\n        }\n\n        return {\n            token: this.token,\n            forStorage: !!this.token,\n            address: query.address,\n            countryCode: query.countryCode || query.country,\n            region: query.stateCode || query.state,\n            city: query.city,\n            postal: query.postalCode,\n            maxLocations: query.limit,\n            langCode: query.language,\n            category: categories.join(','),\n            matchOutOfRange: false,\n            locationType: 'rooftop',\n            outFields: 'Addr_type,LongLabel,AddNum,StAddr,City,RegionAbbr,Region,Country,Postal,DisplayX,DisplayY',\n            f: 'json',\n        };\n    }\n}\n"]}